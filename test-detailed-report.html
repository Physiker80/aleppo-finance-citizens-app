<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงุฎุชุจุงุฑ ุชูุฑูุฑ ุงููุฑุงุณูุงุช ุงูููุตู</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 50%, #581c87 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .report-preview {
            font-family: 'Courier New', monospace;
            white-space: pre-line;
            background: #1a1a1a;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
            border: 2px solid #333;
        }
    </style>
</head>
<body class="min-h-screen p-4">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-3xl font-bold text-white text-center mb-8">๐ ุชูุฑูุฑ ุงูุฅุญุตุงุฆูุงุช ุงูููุตู - ูุฏูุฑูุฉ ูุงููุฉ ุญูุจ</h1>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- ููุญุฉ ุงูุชุญูู -->
            <div class="glass rounded-lg p-6">
                <h2 class="text-xl font-semibold text-white mb-4">๐๏ธ ููุญุฉ ุงูุชุญูู</h2>
                
                <div class="space-y-4">
                    <button onclick="generateSampleData()" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">
                        ๐ ุฅูุดุงุก ุจูุงูุงุช ุชุฌุฑูุจูุฉ
                    </button>
                    
                    <button onclick="generateDetailedReport()" id="reportBtn" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">
                        ๐ ุฅูุดุงุก ุงูุชูุฑูุฑ ุงูููุตู
                    </button>
                    
                    <button onclick="downloadReport()" id="downloadBtn" class="w-full bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg" disabled>
                        ๐พ ุชุญููู ุงูุชูุฑูุฑ
                    </button>
                    
                    <div class="bg-gray-800/50 p-4 rounded-lg">
                        <h3 class="text-white font-medium mb-2">ูุนูููุงุช ุงูุจูุงูุงุช:</h3>
                        <p id="dataInfo" class="text-gray-300 text-sm">ูุง ุชูุฌุฏ ุจูุงูุงุช</p>
                    </div>
                </div>
            </div>

            <!-- ูุนุงููุฉ ุงูุชูุฑูุฑ -->
            <div class="glass rounded-lg p-6">
                <h2 class="text-xl font-semibold text-white mb-4">๐๏ธ ูุนุงููุฉ ุงูุชูุฑูุฑ</h2>
                <div id="reportPreview" class="report-preview">
                    ุงุถุบุท ุนูู "ุฅูุดุงุก ุงูุชูุฑูุฑ ุงูููุตู" ูุนุฑุถ ุงููุนุงููุฉ...
                </div>
            </div>
        </div>
        
        <!-- ูุณู ุงูุฅุญุตุงุฆูุงุช ุงูุณุฑูุนุฉ -->
        <div class="glass rounded-lg p-6 mt-6">
            <h2 class="text-xl font-semibold text-white mb-4">๐ ุงูุฅุญุตุงุฆูุงุช ุงูุณุฑูุนุฉ</h2>
            <div id="quickStats" class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="bg-blue-900/20 p-4 rounded-lg border border-blue-500/30">
                    <div class="text-2xl font-bold text-blue-400" id="totalMessages">0</div>
                    <div class="text-blue-200">ุฅุฌูุงูู ุงููุฑุงุณูุงุช</div>
                </div>
                <div class="bg-green-900/20 p-4 rounded-lg border border-green-500/30">
                    <div class="text-2xl font-bold text-green-400" id="responseRate">0%</div>
                    <div class="text-green-200">ูุนุฏู ุงูุงุณุชุฌุงุจุฉ</div>
                </div>
                <div class="bg-yellow-900/20 p-4 rounded-lg border border-yellow-500/30">
                    <div class="text-2xl font-bold text-yellow-400" id="avgResponse">0</div>
                    <div class="text-yellow-200">ูุชูุณุท ุงูุฑุฏ (ุณุงุนุฉ)</div>
                </div>
                <div class="bg-purple-900/20 p-4 rounded-lg border border-purple-500/30">
                    <div class="text-2xl font-bold text-purple-400" id="performance">0</div>
                    <div class="text-purple-200">ููุงุท ุงูุฃุฏุงุก</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentReportText = '';

        // ุฅูุดุงุก ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
        function generateSampleData() {
            // ุงุณุชุฎุฏุงู ุงูุฃูุณุงู ูู ุงููููู ุงูุฅุฏุงุฑู
            const departments = [
                'ูุณู ุงูุฅุฏุงุฑุฉ ุงูุนุงูุฉ',
                'ูุณู ุงูุฏุฎู', 
                'ูุณู ูุจุงุฑ ููุชูุณุทู ุงููููููู',
                'ูุณู ุงููุชุงุจุนุฉ ูุฅุฏุงุฑุฉ ุงูุฏููู',
                'ูุณู ุงููุงุฑุฏุงุช',
                'ูุณู ุงูุฑูุงุจุฉ ุงูุฏุงุฎููุฉ',
                'ูุณู ุงููุนูููุงุชูุฉ',
                'ูุณู ุงูุชูููุฉ ุงูุฅุฏุงุฑูุฉ', 
                'ูุณู ุงูุงุณุชุนูุงู',
                'ูุณู ุงูุฎุฒููุฉ'
            ];
            const messages = [];

            for (let i = 0; i < 25; i++) {
                const dept = departments[Math.floor(Math.random() * departments.length)];
                const isFromDiwan = Math.random() > 0.5;
                const sentDate = new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000);
                const priority = Math.random() > 0.7 ? 'ุนุงุฌู' : Math.random() > 0.5 ? 'ูุงู' : 'ุนุงุฏู';
                const status = Math.random() > 0.2 ? 'ูุฌุงุจ' : 'ููุฏ_ุงููุฑุงุฌุนุฉ';
                
                const responseHours = priority === 'ุนุงุฌู' ? 2 + Math.random() * 6 : 
                                    priority === 'ูุงู' ? 8 + Math.random() * 16 : 
                                    24 + Math.random() * 72;

                const message = {
                    id: `internal_${Date.now()}_${i}`,
                    from: isFromDiwan ? 'ุฅุฏุงุฑุฉ ุงูุฏููุงู ุงูุนุงู' : dept,
                    to: isFromDiwan ? dept : 'ุฅุฏุงุฑุฉ ุงูุฏููุงู ุงูุนุงู',
                    subject: `${isFromDiwan ? 'ุชุนูููุงุช' : 'ุชูุฑูุฑ'} ${priority} - ${dept}`,
                    content: `ูุญุชูู ุงููุฑุงุณูุฉ ุงูุฎุงุตุฉ ุจู ${dept}`,
                    priority: priority,
                    status: status,
                    sentAt: sentDate.toISOString(),
                    receivedAt: new Date(sentDate.getTime() + Math.random() * 2 * 60 * 60 * 1000).toISOString(),
                    respondedAt: status === 'ูุฌุงุจ' ? new Date(sentDate.getTime() + responseHours * 60 * 60 * 1000).toISOString() : null,
                    direction: isFromDiwan ? 'ูู_ุงูุฏููุงู' : 'ุฅูู_ุงูุฏููุงู'
                };

                messages.push(message);
            }

            localStorage.setItem('internalMessages', JSON.stringify(messages));
            
            // ุชุญุฏูุซ ูุนูููุงุช ุงูุจูุงูุงุช
            document.getElementById('dataInfo').textContent = `ุชู ุฅูุดุงุก ${messages.length} ูุฑุงุณูุฉ ุฅุฏุงุฑูุฉ ุชุฌุฑูุจูุฉ`;
            
            // ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ุงูุณุฑูุนุฉ
            updateQuickStats(messages);
            
            alert(`โ ุชู ุฅูุดุงุก ${messages.length} ูุฑุงุณูุฉ ุฅุฏุงุฑูุฉ ุชุฌุฑูุจูุฉ`);
        }

        // ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช ุงูุณุฑูุนุฉ
        function updateQuickStats(messages) {
            const totalMessages = messages.length;
            const respondedMessages = messages.filter(msg => msg.respondedAt).length;
            const responseRate = Math.round((respondedMessages / totalMessages) * 100);
            
            const responseTimes = messages
                .filter(msg => msg.respondedAt)
                .map(msg => Math.round((new Date(msg.respondedAt).getTime() - new Date(msg.sentAt).getTime()) / (1000 * 60 * 60)));
            
            const avgResponse = responseTimes.length > 0 ? Math.round(responseTimes.reduce((a, b) => a + b, 0) / responseTimes.length) : 0;
            const performance = Math.min(100, Math.round((responseRate * 0.4) + (Math.max(0, 100 - avgResponse) * 0.3) + (totalMessages > 0 ? 30 : 0)));

            document.getElementById('totalMessages').textContent = totalMessages;
            document.getElementById('responseRate').textContent = responseRate + '%';
            document.getElementById('avgResponse').textContent = avgResponse;
            document.getElementById('performance').textContent = performance + '/100';
        }

        // ุฅูุดุงุก ุงูุชูุฑูุฑ ุงูููุตู
        function generateDetailedReport() {
            const messages = JSON.parse(localStorage.getItem('internalMessages') || '[]');
            
            if (messages.length === 0) {
                alert('โ ูุง ุชูุฌุฏ ูุฑุงุณูุงุช. ุฃูุดุฆ ุจูุงูุงุช ุชุฌุฑูุจูุฉ ุฃููุงู.');
                return;
            }

            const currentDate = new Date();
            
            // ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช
            const totalOutgoing = messages.filter(msg => msg.direction === 'ูู_ุงูุฏููุงู').length;
            const totalIncoming = messages.filter(msg => msg.direction === 'ุฅูู_ุงูุฏููุงู').length;
            const totalResponded = messages.filter(msg => msg.respondedAt).length;
            const responseRate = Math.round((totalResponded / messages.length) * 100);

            const responseTimes = messages
                .filter(msg => msg.respondedAt)
                .map(msg => Math.round((new Date(msg.respondedAt).getTime() - new Date(msg.sentAt).getTime()) / (1000 * 60 * 60)));
            
            const averageResponseTime = responseTimes.length > 0 ? Math.round(responseTimes.reduce((a, b) => a + b, 0) / responseTimes.length) : 0;

            // ุฅุญุตุงุฆูุงุช ุงูุฃููููุฉ
            const urgentCount = messages.filter(msg => msg.priority === 'ุนุงุฌู').length;
            const importantCount = messages.filter(msg => msg.priority === 'ูุงู').length;
            const normalCount = messages.filter(msg => msg.priority === 'ุนุงุฏู').length;

            // ุฅุญุตุงุฆูุงุช ุงูุฃูุณุงู
            const departmentStats = {};
            messages.forEach(msg => {
                const dept = msg.direction === 'ูู_ุงูุฏููุงู' ? msg.to : msg.from;
                if (!departmentStats[dept]) {
                    departmentStats[dept] = { sent: 0, received: 0, avgResponse: 0 };
                }
                
                if (msg.direction === 'ูู_ุงูุฏููุงู') {
                    departmentStats[dept].sent++;
                } else {
                    departmentStats[dept].received++;
                }

                if (msg.respondedAt) {
                    const responseTime = Math.round((new Date(msg.respondedAt).getTime() - new Date(msg.sentAt).getTime()) / (1000 * 60 * 60));
                    departmentStats[dept].avgResponse = Math.round((departmentStats[dept].avgResponse + responseTime) / 2);
                }
            });

            const performanceScore = Math.min(100, Math.round((responseRate * 0.4) + (Math.max(0, 100 - averageResponseTime) * 0.3) + 30));

            currentReportText = `โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                          ูุฏูุฑูุฉ ูุงููุฉ ุญูุจ - ุชูุฑูุฑ ุงูุฅุญุตุงุฆูุงุช ุงูุฒูููุฉ ูููุฑุงุณูุงุช                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ ูุนูููุงุช ุงูุชูุฑูุฑ:
โโโโโโโโโโโโโโโโโโโโโโโ
โข ุชุงุฑูุฎ ุงูุชูุฑูุฑ: ${currentDate.toLocaleDateString('ar-SY-u-nu-latn')} - ${currentDate.toLocaleTimeString('ar-SY-u-nu-latn')}
โข ุงููุชุฑุฉ ุงูุฒูููุฉ: ุขุฎุฑ 30 ูููุงู
โข ููุน ุงูุชูุฑูุฑ: ุงููุฑุงุณูุงุช ุงูุฅุฏุงุฑูุฉ ุงูุฏุงุฎููุฉ
โข ุงููุฑุดุญุงุช ุงููุทุจูุฉ: ุฌููุน ุงูุฃูุณุงู | ุฌููุน ุงูุงุชุฌุงูุงุช

๐ ุงูุฅุญุตุงุฆูุงุช ุงูุนุงูุฉ:
โโโโโโโโโโโโโโโโโโโโโโโ
โข ุฅุฌูุงูู ุงููุฑุงุณูุงุช: ${messages.length} ูุฑุงุณูุฉ
โข ุงููุฑุงุณูุงุช ุงูุตุงุฏุฑุฉ: ${totalOutgoing} ูุฑุงุณูุฉ (ูู ุงูุฏููุงู ุฅูู ุงูุฃูุณุงู)
โข ุงููุฑุงุณูุงุช ุงููุงุฑุฏุฉ: ${totalIncoming} ูุฑุงุณูุฉ (ูู ุงูุฃูุณุงู ุฅูู ุงูุฏููุงู)
โข ูุนุฏู ุงูุงุณุชุฌุงุจุฉ: ${responseRate}% (${totalResponded} ูู ุฃุตู ${messages.length})
โข ูุชูุณุท ููุช ุงูุฑุฏ: ${averageResponseTime} ุณุงุนุฉ

๐ฏ ุงูุฃููููุงุช:
โโโโโโโโโโโโโ
โข ุนุงุฌู: ${urgentCount} ูุฑุงุณูุฉ
โข ูุงู: ${importantCount} ูุฑุงุณูุฉ  
โข ุนุงุฏู: ${normalCount} ูุฑุงุณูุฉ

๐ข ุงูุฃูุณุงู:
โโโโโโโโโโโ
${Object.entries(departmentStats).map(([dept, data]) => 
  `โข ${dept}: ููุฑุณูุฉ ${data.sent} - ููุณุชูุจูุฉ ${data.received} (ูุชูุณุท: ${data.avgResponse || 0} ุณุงุนุฉ)`
).join('\n')}

๐ค ุงูุชุญููู ุงูุฐูู (Gemini 2.5 Pro):
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โข ููุงุท ุงูุฃุฏุงุก ุงูุฅุฌูุงููุฉ: ${performanceScore}/100
${performanceScore >= 80 ? 'โ ุฃุฏุงุก ููุชุงุฒ - ุงุณุชูุฑ ูู ุงูุนูู ุงูุฌูุฏ' :
  performanceScore >= 60 ? 'โ๏ธ ุฃุฏุงุก ุฌูุฏ - ูููู ุชุญุณููู' :
  '๐ด ุฃุฏุงุก ูุญุชุงุฌ ุชุญุณูู - ุฑุงุฌุน ุณูุฑ ุงูุนูู'}

๐ ุชูุตูุงุช ุงูุชุญุณูู:
โโโโโโโโโโโโโโโโโโโ
${responseRate < 80 ? 'โข ุฒูุงุฏุฉ ูุนุฏู ุงูุงุณุชุฌุงุจุฉ ูููุฑุงุณูุงุช\n' : ''}${averageResponseTime > 24 ? 'โข ุชูููู ููุช ุงูุงุณุชุฌุงุจุฉ ูููุฑุงุณูุงุช\n' : ''}โข ุชุทุจูู ูุธุงู ูุชุงุจุนุฉ ุฏูุฑู ูููุฑุงุณูุงุช ุงููุนููุฉ
โข ุชุฏุฑูุจ ุงูููุธููู ุนูู ุฃูููุฉ ุงูุฑุฏ ุงูุณุฑูุน

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ ุชูุงุตูู ุฅุถุงููุฉ:
โข ุนุฏุฏ ุงูุฃูุณุงู ุงููุดุทุฉ: ${Object.keys(departmentStats).length}
โข ุฃุณุฑุน ูุณู ูู ุงูุฑุฏ: ${Object.entries(departmentStats).sort((a, b) => a[1].avgResponse - b[1].avgResponse)[0]?.[0] || 'ุบูุฑ ูุชุงุญ'}
โข ุฃุจุทุฃ ูุณู ูู ุงูุฑุฏ: ${Object.entries(departmentStats).sort((a, b) => b[1].avgResponse - a[1].avgResponse)[0]?.[0] || 'ุบูุฑ ูุชุงุญ'}

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐๏ธ ููููููุฏ ุจูุงุณุทุฉ: ูุธุงู ุงูุงุณุชุนูุงูุงุช ูุงูุดูุงูู - ูุฏูุฑูุฉ ูุงููุฉ ุญูุจ
๐ ุชุงุฑูุฎ ุงูุฅูุดุงุก: ${currentDate.toLocaleString('ar-SY-u-nu-latn')}
๐ ุฅุตุฏุงุฑ ุงููุธุงู: v2.5.0 ูุน ุชุญููู ุงูุฐูุงุก ุงูุงุตุทูุงุนู`;

            // ุนุฑุถ ุงููุนุงููุฉ
            document.getElementById('reportPreview').textContent = currentReportText;
            document.getElementById('downloadBtn').disabled = false;
            
            alert('โ ุชู ุฅูุดุงุก ุงูุชูุฑูุฑ ุงูููุตู ุจูุฌุงุญ!');
        }

        // ุชุญููู ุงูุชูุฑูุฑ
        function downloadReport() {
            if (!currentReportText) {
                alert('โ ูุง ููุฌุฏ ุชูุฑูุฑ ูุชุญูููู. ุฃูุดุฆ ุงูุชูุฑูุฑ ุฃููุงู.');
                return;
            }

            const blob = new Blob([currentReportText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            
            const currentDate = new Date();
            const filename = `ุชูุฑูุฑ_ูุฑุงุณูุงุช_ูุฏูุฑูุฉ_ูุงููุฉ_ุญูุจ_${currentDate.getFullYear()}-${(currentDate.getMonth() + 1).toString().padStart(2, '0')}-${currentDate.getDate().toString().padStart(2, '0')}.txt`;
            
            link.href = url;
            link.download = filename;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('โ ุชู ุชุญููู ุงูุชูุฑูุฑ ุจูุฌุงุญ!');
        }

        // ุชุญููู ุงูุจูุงูุงุช ุนูุฏ ูุชุญ ุงูุตูุญุฉ
        window.onload = function() {
            const messages = JSON.parse(localStorage.getItem('internalMessages') || '[]');
            if (messages.length > 0) {
                document.getElementById('dataInfo').textContent = `ููุฌุฏ ${messages.length} ูุฑุงุณูุฉ ูุญููุธุฉ`;
                updateQuickStats(messages);
            }
        };
    </script>
</body>
</html>